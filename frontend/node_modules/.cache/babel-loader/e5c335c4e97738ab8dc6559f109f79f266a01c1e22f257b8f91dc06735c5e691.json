{"ast":null,"code":"import React,{useEffect,useState,useRef}from\"react\";import{Link,useNavigate,useParams}from\"react-router-dom\";import ParticlesComponent from\"../components/ParticlesComponent\";import axios from\"axios\";import io from\"socket.io-client\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Chat(){const{groupId}=useParams();const backend=\"http://localhost:5100\";const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[newMessage,setNewMessage]=useState(\"\");const[typing,setTyping]=useState(\"\");const[groupData,setGroupData]=useState({});const socket=useRef(null);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");// Retrieve the token from localStorage\nconst user=localStorage.getItem(\"username\");// Retrieve the username from localStorage\nif(token){// Check if the token exists\nsocket.current=io(backend,{auth:{token:token// Pass the token in the headers for authentication\n}});const fetchData=async()=>{try{const response=await axios.get(\"\".concat(backend,\"/group/\").concat(groupId,\"/messages\"),{headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(token)// Include the token in the request headers\n}});if(response.status===200){const data=response.data;const mymsg=data.map(msg=>{return{message:msg.message,sender:msg.sender.username};});setMessages(mymsg);}else{console.error(\"Failed to fetch messages\");}const groupName=await axios.get(\"\".concat(backend,\"/group/\").concat(groupId),{headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(token)// Include the token in the request headers\n}});if(groupName.status===200){const groupNameData=groupName;setGroupData(groupNameData);}}catch(error){console.error(\"Error fetching messages:\",error);}finally{setLoading(false);}};fetchData();// Listen for new messages\nsocket.current.on(\"message\",newMessage=>{console.log(\"New message:\",newMessage);setMessages(prevMessages=>[...prevMessages,newMessage]);});// Listen for typing\nsocket.current.on(\"type\",user=>{// console.log(\"Typing:\", user);\nsetTyping(user,\" is typing ...\");});socket.current.on(\"stopTyping\",()=>{setTyping(\"\");});// Cleanup on component unmount\nreturn()=>{socket.current.disconnect();};}},[groupId,backend]);useEffect(()=>{if(!groupData||!groupData.data)return;const username=localStorage.getItem(\"username\");// Retrieve the username from localStorage\nconst userId=localStorage.getItem(\"id\");// Retrieve the userId from localStorage\nconsole.log(\"Joining room:\",groupData.data.name);socket.current.emit(\"joinRoom\",{username:username,userId:userId,room:groupData.data.name,groupId:groupId,token:localStorage.getItem(\"token\")});},[groupData]);const handleSendMessage=async e=>{e.preventDefault();const token=localStorage.getItem(\"token\");// Retrieve the token from localStorage\nconst userId=localStorage.getItem(\"id\");// Retrieve the userId from localStorage\nconst username=localStorage.getItem(\"username\");// Retrieve the username from localStorage\nif(token){// Check if the token exists\ntry{console.log(\"Sending message:\",newMessage);socket.current.emit(\"chatMessage\",{message:newMessage,sender:userId,group:groupId},groupData.data.name,username);setNewMessage(\"\");setTyping(\"\");}catch(error){console.error(\"Error sending message:\",error);}}};const handleChange=e=>{const message=e.target.value;setNewMessage(message);const username=localStorage.getItem(\"username\");// Retrieve the username from localStorage\nsocket.current.emit(\"typing\",{room:groupData.data.name,username:username});// Emit typing event with the username\nif(message===\"\"){socket.current.emit(\"stopTyping\",{room:groupData.data.name});// Emit stopTyping event\n}};// user leaves the room upadte the database\nconst handleLeaveRoom=async()=>{const token=localStorage.getItem(\"token\");// Retrieve the token from localStorage\nconst userId=localStorage.getItem(\"id\");// Retrieve the userId from localStorage\ntry{const username=localStorage.getItem(\"username\");// Retrieve the username from localStorage\nsocket.current.emit(\"leaveRoom\",{user:userId,username:username,groupId:groupId,name:groupData.data.name});console.log(\"Left the room\");navigate(\"/dashboard\");}catch(error){console.error(\"Error leaving the room:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-start justify-start pl-5 py-4 text-gray-500 bg-[#282828] \",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold\",children:\"Chat\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto min-h-screen min-w-full\",children:[/*#__PURE__*/_jsx(ParticlesComponent,{}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-screen min-w-full px-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col w-full max-w-2xl p-4 relative bg-gray-800/80 rounded-lg shadow-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-200\",children:\"Chat\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 justify-center items-center\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"px-3 py-1 text-sm font-semibold text-gray-200 bg-red-600 rounded hover:bg-red-800 transition duration-200 ease-in-out\",onClick:handleLeaveRoom,children:\"Leave\"}),/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"px-3 py-1 text-sm font-semibold text-gray-200 bg-gray-500 rounded hover:bg-slate-900 transition duration-200 ease-in-out\",children:\"back\"})]})]}),typing&&/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-200 text-sm\",children:typing}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col justify-center items-center mt-4 space-y-4 overflow-y-auto\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 bg-slate-200 min-h-[250px] max-h-[250px] w-9/12 overflow-auto scroll-smooth  rounded-lg text-black border px-3 py-2\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700 text-center\",children:\"Loading messages...\"}):messages.length>0?messages.map((msg,index)=>{var _msg$username;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-start gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-gray-700 text-sm font-semibold\",children:[(_msg$username=msg===null||msg===void 0?void 0:msg.username)!==null&&_msg$username!==void 0?_msg$username:msg.sender,\":\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700 text-sm\",children:msg.message})]},index);}):/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-200 text-center\",children:\"No messages yet\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"w-full flex justify-center items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"newMessage\",value:newMessage,onChange:handleChange,className:\"w-6/12 h-10 pl-3  text-base placeholder-gray-400 text-black border rounded-lg focus:shadow-outline focus:outline-none\",placeholder:\"Type here ....\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:handleSendMessage,name:\"submit\",className:\"text-base px-4 py-2 rounded-lg bg-gray-300/60 text-gray-200 hover:text-gray-900/70 hover:bg-gray-500 focus:outline-none focus:text-gray-900/70  focus:shadow-outline transition duration-200 ease-in-out \",children:\"Send\"})]})})]})]})})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useRef","Link","useNavigate","useParams","ParticlesComponent","axios","io","jsx","_jsx","jsxs","_jsxs","Chat","groupId","backend","messages","setMessages","loading","setLoading","newMessage","setNewMessage","typing","setTyping","groupData","setGroupData","socket","navigate","token","localStorage","getItem","user","current","auth","fetchData","response","get","concat","headers","status","data","mymsg","map","msg","message","sender","username","console","error","groupName","groupNameData","on","log","prevMessages","disconnect","userId","name","emit","room","handleSendMessage","e","preventDefault","group","handleChange","target","value","handleLeaveRoom","children","className","to","onClick","length","index","_msg$username","type","onChange","placeholder"],"sources":["/Users/shaghayeghzarei/Documents/School/Semester 6/Fullstack/101274382_lab_test1_chatapp/101274382_lab_test1_chatapp/frontend/src/screens/chat.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { Link, useNavigate, useParams  } from \"react-router-dom\";\nimport ParticlesComponent from \"../components/ParticlesComponent\";\nimport axios from \"axios\";\nimport io from \"socket.io-client\";\n\n\nexport default function Chat() {\n    const { groupId } = useParams(); \n    const backend = \"http://localhost:5100\";\n    const [messages, setMessages] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [newMessage, setNewMessage] = useState(\"\");\n    const [typing, setTyping] = useState(\"\");\n    const [groupData, setGroupData] = useState({});\n    const socket = useRef(null);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const token = localStorage.getItem(\"token\"); // Retrieve the token from localStorage\n        const user = localStorage.getItem(\"username\"); // Retrieve the username from localStorage\n\n        if (token) { // Check if the token exists\n            socket.current = io(backend, {\n                auth: {\n                    token: token, // Pass the token in the headers for authentication\n                },\n            });\n\n            const fetchData = async () => {\n                try {\n                    const response = await axios.get(`${backend}/group/${groupId}/messages`, {\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"Authorization\": `Bearer ${token}` // Include the token in the request headers\n                        }\n                    });\n\n                    if (response.status === 200) {\n                        const data = response.data;\n                        const mymsg = data.map((msg) => { return { message: msg.message, sender: msg.sender.username } });\n                        setMessages(mymsg);\n                    } else {\n                        console.error(\"Failed to fetch messages\");\n                    }\n                    const groupName = await axios.get(`${backend}/group/${groupId}`, {\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            \"Authorization\": `Bearer ${token}` // Include the token in the request headers\n                        }\n                    });\n\n                    if (groupName.status === 200) {\n                        const groupNameData = groupName;\n                        setGroupData(groupNameData);\n                    }\n\n                } catch (error) {\n                    console.error(\"Error fetching messages:\", error);\n                } finally {\n                    setLoading(false);\n                }\n            };\n\n            fetchData();\n\n            // Listen for new messages\n            socket.current.on(\"message\", (newMessage) => {\n                console.log(\"New message:\", newMessage);\n                setMessages((prevMessages) => [...prevMessages, newMessage]);\n            });\n\n            // Listen for typing\n            socket.current.on(\"type\", (user) => {\n                // console.log(\"Typing:\", user);\n                setTyping(user, \" is typing ...\");\n            });\n\n            socket.current.on(\"stopTyping\", () => {\n                setTyping(\"\");\n            });\n\n            // Cleanup on component unmount\n            return () => {\n                socket.current.disconnect();\n            };\n        }\n    }, [groupId, backend]);\n\n    useEffect(() => {\n\n        if(!groupData || !groupData.data) return;\n        const username = localStorage.getItem(\"username\"); // Retrieve the username from localStorage\n        const userId = localStorage.getItem(\"id\"); // Retrieve the userId from localStorage\n        console.log(\"Joining room:\", groupData.data.name);\n        socket.current.emit(\"joinRoom\", { username: username, userId: userId, room: groupData.data.name, groupId: groupId, token: localStorage.getItem(\"token\")});\n\n    }, [groupData]);\n    \n\n    const handleSendMessage = async (e) => {\n        e.preventDefault();\n\n        const token = localStorage.getItem(\"token\"); // Retrieve the token from localStorage\n        const userId = localStorage.getItem(\"id\"); // Retrieve the userId from localStorage\n        const username = localStorage.getItem(\"username\"); // Retrieve the username from localStorage\n    \n\n        if (token) { // Check if the token exists\n            try {\n                console.log(\"Sending message:\", newMessage);\n                socket.current.emit(\"chatMessage\",\n                    { message: newMessage, sender: userId, group: groupId }, groupData.data.name, username);\n                setNewMessage(\"\");\n                setTyping(\"\");\n\n            } catch (error) {\n                console.error(\"Error sending message:\", error);\n            }\n        }\n    };\n\n\n    const handleChange = (e) => {\n        const message = e.target.value;\n        setNewMessage(message);\n\n        const username = localStorage.getItem(\"username\"); // Retrieve the username from localStorage\n        socket.current.emit(`typing`, { room: groupData.data.name, username: username}); // Emit typing event with the username\n\n        if (message === \"\") {\n            socket.current.emit(`stopTyping`, { room: groupData.data.name }); // Emit stopTyping event\n        }\n    };\n\n    // user leaves the room upadte the database\n    const handleLeaveRoom = async () => {\n        const token = localStorage.getItem(\"token\"); // Retrieve the token from localStorage\n        const userId = localStorage.getItem(\"id\"); // Retrieve the userId from localStorage\n        try {\n    \n            const username = localStorage.getItem(\"username\"); // Retrieve the username from localStorage\n            socket.current.emit(\"leaveRoom\", { user: userId, username: username, groupId: groupId, name: groupData.data.name });\n\n            console.log(\"Left the room\");\n            navigate(\"/dashboard\");\n\n        } catch (error) {\n            console.error(\"Error leaving the room:\", error);\n        }\n    };\n\n\n    return (\n        <div>\n            <div className=\"flex items-start justify-start pl-5 py-4 text-gray-500 bg-[#282828] \">\n                <h1 className=\"text-4xl font-bold\">Chat</h1>\n            </div>\n\n            <div className=\"container mx-auto min-h-screen min-w-full\">\n                <ParticlesComponent />\n\n                <div className=\"flex items-center justify-center min-h-screen min-w-full px-5\">\n                \n                    <div className=\"flex flex-col w-full max-w-2xl p-4 relative bg-gray-800/80 rounded-lg shadow-lg\">\n                        <div className=\"flex items-center justify-between\">\n                            <h1 className=\"text-2xl font-bold text-gray-200\">Chat</h1>\n                            <div className=\"flex gap-2 justify-center items-center\">\n                                <Link to=\"/dashboard\" className=\"px-3 py-1 text-sm font-semibold text-gray-200 bg-red-600 rounded hover:bg-red-800 transition duration-200 ease-in-out\"\n                                onClick={handleLeaveRoom}>\n                                    Leave\n                                </Link>\n                                <Link to=\"/dashboard\" className=\"px-3 py-1 text-sm font-semibold text-gray-200 bg-gray-500 rounded hover:bg-slate-900 transition duration-200 ease-in-out\"\n\n                                >\n                                    back\n                                </Link>\n                            </div>\n                        </div>\n\n                        {typing && (\n                            <div className=\"text-gray-200 text-sm\">{typing}</div>\n                        )}\n                    \n                        <div className=\"flex flex-col justify-center items-center mt-4 space-y-4 overflow-y-auto\">\n                            <div className=\"flex-1 bg-slate-200 min-h-[250px] max-h-[250px] w-9/12 overflow-auto scroll-smooth \n                        rounded-lg text-black border px-3 py-2\">\n                                {loading ? (\n                                    <div className=\"text-gray-700 text-center\">Loading messages...</div>\n                                ) : messages.length > 0 ? (\n                                    messages.map((msg, index) => (\n                                        <div key={index} className=\"flex items-center justify-start gap-2\">\n                                            <div className=\"text-gray-700 text-sm font-semibold\">{msg?.username ?? msg.sender}:</div>\n                                            <div className=\"text-gray-700 text-sm\">{msg.message}</div>\n                                        </div>\n                                    ))\n                                ) : (\n                                    <div className=\"text-gray-200 text-center\">No messages yet</div>\n                                )}\n                            \n                            </div>\n                            <div className=\"w-full\">\n                                <form  className=\"w-full flex justify-center items-center gap-2\">\n                                    <input\n                                        type=\"text\"\n                                        name=\"newMessage\"\n                                        value={newMessage}\n                                        onChange={handleChange}\n                                        className=\"w-6/12 h-10 pl-3  text-base placeholder-gray-400 text-black border rounded-lg focus:shadow-outline focus:outline-none\"\n                                        placeholder=\"Type here ....\"\n                                    />\n                                    <button type=\"submit\" onClick={handleSendMessage} name=\"submit\" className=\"text-base px-4 py-2 rounded-lg bg-gray-300/60 text-gray-200\n                                    hover:text-gray-900/70 hover:bg-gray-500 focus:outline-none focus:text-gray-900/70 \n                                    focus:shadow-outline transition duration-200 ease-in-out\n                                \">Send</button>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n\n\n            </div>\n        </div>\n    );\n}\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}